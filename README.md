# Emotion Prediction in the Darkness

This is the thesis project about emotion prediction in the darkness. This github repo contains three ipynb files, which can be opened in Google Colab. In every file, you can find detailed comments. If you have questions, please contract me by : <wangqy1216@gmail.com>. 

**[Thesis](https://drive.google.com/file/d/1uzN9n2T7Dl4Gmr7JGXVuFTe7w55UjV0g/view?usp=sharing)

## EnlightenCycleGAN.ipynb
This file is to train a CycleGAN-based Model for dark image inhancement. 

The paired dataset is collected by random selection from some popular dark image datasets. **[EnlightenCycleGAN](https://drive.google.com/file/d/1n7-mk_zrs2RmIrLcBNY4kOV1L5dmavu1/view?usp=sharing)**

Please open the ipynb file, then download the dataset and train the model.


## Train.ipynb
### Dataset
I used KDEF dataset to train a emotion prediction model. Because of copyright, I can't provide KDEF dataset. I have two trained model. **[SVM](https://drive.google.com/file/d/11xyf4vQk1yESyAchQwiYcgZL7bBYxLGP/view?usp=sharing)** **[Random Forest](https://drive.google.com/file/d/11xyf4vQk1yESyAchQwiYcgZL7bBYxLGP/view?usp=sharing)** **[MLP](https://drive.google.com/file/d/11xyf4vQk1yESyAchQwiYcgZL7bBYxLGP/view?usp=sharing)** 

### Landmark Generation
The landmarks were generated by **[LBFModel](https://github.com/kurnianggoro/GSOC2017/raw/master/data/lbfmodel.yaml)** 

### Normalization
This file compares three different feature extraction methods : Feature Descriptor, Points Distances and Polar Coordinate.

Due to the variant of face shapes and distance from camera to face, normalization is necessary. We used the distance from the nose lip to the eyebrows' center as the normalization distance.

### Training
I used SVM, Random Forest and MLP to train the emotion prediction model.

## Application.ipynb
This file is a simple application file using the pre-trained models. This file takes the real time video as the input. To test this model, please turn down the lights, sit in the front of the camera and run the file.


## Result
[![DARK AND ENHANCED](http://img.youtube.com/vi/hr2OO0q3rkU/0.jpg)](http://www.youtube.com/watch?v=hr2OO0q3rkU)


